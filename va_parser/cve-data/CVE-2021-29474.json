{
    "title": "HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker can read arbitrary `.md` files from the servers filesystem due to an improper input validation, which results in the ability to perform a relative path traversal. To verify if you are affected, you can try to open the following URL: `http://localhost:3000/..%2F..%2FREADME#` (replace `http://localhost:3000` with your instances base-URL e.g. `https://demo.hedgedoc.org/..%2F..%2FREADME#`). If you see a README page being rendered, you run an affected version. The attack works due the fact that the internal router passes the url-encoded alias to the `noteController.showNote`-function. This function passes the input directly to findNote() utility function, that will pass it on the the parseNoteId()-function, that tries to make sense out of the noteId/alias and check if a note already exists and if so, if a corresponding file on disk was updated. If no note exists the note creation-function is called, which pass this unvalidated alias, with a `.md` appended, into a path.join()-function which is read from the filesystem in the follow up routine and provides the pre-filled content of the new note. This allows an attacker to not only read arbitrary `.md` files from the filesystem, but also observes changes to them. The usefulness of this attack can be considered limited, since mainly markdown files are use the file-ending `.md` and all markdown files contained in the hedgedoc project, like the README, are public anyway. If other protections such as a chroot or container or proper file permissions are in place, this attacks usefulness is rather limited. On a reverse-proxy level one can force a URL-decode, which will prevent this attack because the router will not accept such a path.",
    "score": 5.8,
    "severity": "MEDIUM",
    "cwe_id": "CWE-22",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N",
    "cpe_match": [
        "cpe:2.3:a:hedgedoc:hedgedoc:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "technique_id": "T1071",
            "confidence": "93.1",
            "technique_name": "Application Layer Protocol"
        },
        {
            "technique_id": "T1016",
            "confidence": "11.6",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "10.6",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "11.2",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1482",
            "confidence": "14.7",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1115",
            "confidence": "10.9",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1140",
            "confidence": "20.4",
            "technique_name": "Deobfuscate/Decode Files or Information"
        },
        {
            "technique_id": "T1070.004",
            "confidence": "12.9",
            "technique_name": "File Deletion"
        },
        {
            "technique_id": "T1083",
            "confidence": "46.0",
            "technique_name": "File and Directory Discovery"
        },
        {
            "technique_id": "T1057",
            "confidence": "11.3",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "21.3",
            "technique_name": "Native API"
        }
    ]
}
