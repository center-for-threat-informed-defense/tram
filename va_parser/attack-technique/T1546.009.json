{
    "id": "T1546.009",
    "name": "AppCert DLLs",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppCertDLLs</code> Registry key under <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\</code> are loaded into every process that calls the ubiquitously used application programming interface (API) functions <code>CreateProcess</code>, <code>CreateProcessAsUser</code>, <code>CreateProcessWithLoginW</code>, <code>CreateProcessWithTokenW</code>, or <code>WinExec</code>. (Citation: Elastic Process Injection July 2017)\n\nSimilar to [Process Injection](https://attack.mitre.org/techniques/T1055), this value can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. Malicious AppCert DLLs may also provide persistence by continuously being triggered by API activity. ",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1546/009",
            "external_id": "T1546.009"
        },
        {
            "source_name": "Elastic Process Injection July 2017",
            "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.",
            "url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
        },
        {
            "source_name": "TechNet Autoruns",
            "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
            "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
        },
        {
            "source_name": "Sysinternals AppCertDlls Oct 2007",
            "description": "Microsoft. (2007, October 24). Windows Sysinternals - AppCertDlls. Retrieved December 18, 2017.",
            "url": "https://forum.sysinternals.com/appcertdlls_topic12546.html"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "privilege-escalation"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        }
    ],
    "tactic": [
        "privilege-escalation",
        "persistence"
    ],
    "x_mitre_detection": "Monitor DLL loads by processes, specifically looking for DLLs that are not recognized or not normally loaded into a process. Monitor the AppCertDLLs Registry value for modifications that do not correlate with known software, patch cycles, etc. Monitor and analyze application programming interface (API) calls that are indicative of Registry edits such as RegCreateKeyEx and RegSetValueEx. (Citation: Elastic Process Injection July 2017) \n\nTools such as Sysinternals Autoruns may overlook AppCert DLLs as an auto-starting location. (Citation: TechNet Autoruns) (Citation: Sysinternals AppCertDlls Oct 2007)\n\nLook for abnormal process behavior that may be due to a process loading a malicious DLL. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as making network connections for Command and Control, learning details about the environment through Discovery, and conducting Lateral Movement.",
    "x_mitre_data_sources": [
        "Module: Module Load",
        "Windows Registry: Windows Registry Key Modification",
        "Process: OS API Execution",
        "Process: Process Creation",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": [
        "Administrator",
        "SYSTEM"
    ],
    "x_mitre_effective_permissions": [
        "Administrator",
        "SYSTEM"
    ],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Execution Prevention",
                "description": "Block execution of code on a system through application control, and/or script blocking.",
                "type": "course-of-action",
                "id": "M1038"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that application whitelisting tools are configured to Identify and block potentially malicious software executed through AppCertDLLs functionality",
                "acid": "98580688"
            },
            {
                "description": "Ensure that Software Restriction Policies are implemented to Identify and block potentially malicious software executed through AppCertDLLs functionality",
                "acid": "98580689"
            },
            {
                "description": "Ensure that Windows Defender Application Control is configured to identify and block potentially malicious software executed through AppCertDLLs functionality",
                "acid": "98580690"
            },
            {
                "description": "Ensure that AppLocker is configured to identify and block potentially malicious software executed through AppCertDLLs functionality",
                "acid": "98580691"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that DLL Loads by processes are monitored for unrecognized or unfamiliar DLL loads",
                "acid": "98580684"
            },
            {
                "description": "Ensure that changes to AppCertDLLs Registry value that do not correlate with known software, patch cycles, etc are monitored",
                "acid": "98580685"
            },
            {
                "description": "Ensure that API calls for registry edits are monitored and analyzed",
                "acid": "98580686"
            },
            {
                "description": "Ensure that process loading DLLs must be monitored for malicious DLLs",
                "acid": "98580687"
            }
        ]
    },
    "cspcontrolIds": [],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [],
    "cveIds": []
}
